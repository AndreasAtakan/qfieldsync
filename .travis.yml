language: python
dist: trusty
sudo: true
python:
- 2.7
virtualenv:
  system_site_packages: true
before_install:
- sudo apt-get -qq -y update
install:
- printf "deb http://qgis.org/debian trusty main\ndeb-src http://qgis.org/debian trusty
  main" | sudo tee /etc/apt/sources.list.d/qgis.list
- sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-key 073D307A618E5811
- sudo apt-get update
- sudo apt-get install -y python-qgis python-nose pyqt4-dev-tools qgis
- pip install -r requirements.txt
- "./scripts/ci/install_qgis2compat.sh"
before_script:
- export QGIS_PREFIX_PATH=/usr
- export PYTHONPATH=${QGIS_PREFIX_PATH}/share/qgis/python/:${QGIS_PREFIX_PATH}/share/qgis/python/plugins:`pwd`/qfieldsync:${PYTHONPATH}
- echo "PYTHONPATH:" ${PYTHONPATH}
- export LD_LIBRARY_PATH=${QGIS_PREFIX_PATH}/lib
script:
- flake8 --jobs=1
- xvfb-run nose2
after_success:
- scripts/ci/deploy.sh

env:
  global:
    - OSGEO_USERNAME=mkuhn
      secure: az6wOL9x75dW3n/h/+8T/6yq2di7AjLF/GKtGE1pdRDa8qVbN0xMhSdewP3BXtisUIktPrzgYmNZFjMKf/0owSPcZQ4cAOZhqACOnmz+occ7N3JeCaI92eHy2XR9d/kKOgmu1uUREc32lV9Umw/4fj2FEKNwliZ7eK8PrUa6aLkw9ffret+V8jxsaQCOHqLtGd7n2MN28dihaTuabj8JWZPe5Oab/ZnfUuisdoxtof0eCSqmfN9w8hIm4njIc1dzOG0Na1q/5lK3TLMd0GMAp6eNgT1oBW8l3onPwI06a8MyU/CVP4x/lH0Do+Icnwgcql/TcavP0jQkmflsR/sPPfbNjf7Kz8bMzO1bM/oM7+njBF3VVynVq8Auy4RJ+g/PJXDYEBcnFvswjOiA51z8ONWK/+lPcCVVfR8z+rhcmqkbb8ru04syMZtNMORdKaM6/1aPhCEUOouJpqIJ7vYpQZqDvlt2YaqvUO/LZ3IHrai896ih2QoupS5Wk+wBbg6DksQG4spUWrJ5ePzykgQh567K2dTJvstGwfBSrTDTWRLfvdMbg4YrNA6UFc4gu0gD51I+0NLn9H7XDHEv1RhSY7GS2qZ+sXTbnMgg+XTzFV/FbhfNDIrmM8gNcfG9jrlacn/+xOZYsBTWsXvq26qausXK6RpYsUYfBn5c6UvqQBQ=
